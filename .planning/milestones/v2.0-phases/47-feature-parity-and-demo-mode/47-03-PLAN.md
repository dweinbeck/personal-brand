---
phase: 47-feature-parity-and-demo-mode
plan: 03
type: execute
wave: 2
depends_on: [47-01, 47-02]
files_modified:
  - src/data/demo-seed.ts
  - src/components/tasks/demo/DemoProvider.tsx
  - src/components/tasks/demo/DemoBanner.tsx
  - src/components/tasks/demo/DemoSidebar.tsx
  - src/app/apps/tasks/demo/layout.tsx
  - src/app/apps/tasks/demo/page.tsx
  - src/app/apps/tasks/demo/[projectId]/page.tsx
  - src/app/apps/tasks/demo/[projectId]/demo-project-view.tsx
autonomous: true
requirements: [DM-01, DM-02, DM-03, DM-04]

must_haves:
  truths:
    - "Visiting /apps/tasks/demo loads a fully functional demo with read-only tasks, no sign-in required"
    - "Demo uses in-memory seed data with ~40 realistic tasks across 4 projects in 2 workspaces"
    - "Demo banner displays at top with DEMO badge, explanatory text, and Sign Up Free CTA"
    - "All task interactions (toggle, edit, delete) are prevented in demo mode -- no database writes occur"
    - "Demo includes tasks with subtasks, tags, effort scores, deadlines, and completed status"
  artifacts:
    - path: "src/data/demo-seed.ts"
      provides: "Static seed data: ~40 tasks, 4 projects, 2 workspaces, 8 tags"
      min_lines: 300
    - path: "src/components/tasks/demo/DemoProvider.tsx"
      provides: "Context provider wrapping demo routes with seed data"
    - path: "src/components/tasks/demo/DemoBanner.tsx"
      provides: "Sticky demo banner with CTA"
    - path: "src/components/tasks/demo/DemoSidebar.tsx"
      provides: "Read-only sidebar for demo navigation"
    - path: "src/app/apps/tasks/demo/layout.tsx"
      provides: "Demo layout with DemoModeProvider, DemoProvider, DemoBanner, DemoSidebar"
    - path: "src/app/apps/tasks/demo/[projectId]/demo-project-view.tsx"
      provides: "Read-only project view for demo with list/board toggle"
  key_links:
    - from: "src/app/apps/tasks/demo/layout.tsx"
      to: "src/components/tasks/demo/DemoProvider.tsx"
      via: "DemoProvider context wrapping children"
      pattern: "DemoProvider"
    - from: "src/app/apps/tasks/demo/[projectId]/page.tsx"
      to: "src/components/tasks/demo/DemoProvider.tsx"
      via: "useDemoContext hook"
      pattern: "useDemoContext"
    - from: "src/lib/tasks/demo.ts"
      to: "src/components/tasks/task-card.tsx"
      via: "useDemoMode guard disabling mutations"
      pattern: "useDemoMode"
---

<objective>
Create the demo mode at /apps/tasks/demo with in-memory seed data, read-only views, and a persistent demo banner with sign-up CTA.

Purpose: Allow visitors to experience the full Tasks app without signing in, using realistic sample data that demonstrates all features (subtasks, tags, effort scores, multiple projects, sections).
Output: Complete demo mode route with layout, sidebar, project views, seed data, and mutation guards.
</objective>

<execution_context>
@/Users/dweinbeck/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dweinbeck/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/35-demo-workspace/35-01-SUMMARY.md
@.planning/phases/35-demo-workspace/35-02-SUMMARY.md

Reference for patterns:
@src/lib/tasks/demo.ts (DemoModeProvider and useDemoMode - already exists)
@src/components/tasks/task-card.tsx (has useDemoMode guard already)
@src/components/tasks/subtask-list.tsx (has useDemoMode guard already)
@src/components/tasks/section-header.tsx (has useDemoMode guard already)

Source reference from todoist (adapt, don't copy-paste):
todoist/src/data/demo-seed.ts (648 lines, ~40 tasks)
todoist/src/components/demo/DemoBanner.tsx
todoist/src/components/demo/DemoProvider.tsx
todoist/src/components/demo/DemoSidebar.tsx
todoist/src/app/demo/layout.tsx
todoist/src/app/demo/page.tsx
todoist/src/app/demo/[projectId]/page.tsx
todoist/src/app/demo/[projectId]/demo-project-view.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create demo seed data and demo components</name>
  <files>
    src/data/demo-seed.ts
    src/components/tasks/demo/DemoProvider.tsx
    src/components/tasks/demo/DemoBanner.tsx
    src/components/tasks/demo/DemoSidebar.tsx
  </files>
  <action>
    Create the demo infrastructure files, adapted from the todoist standalone app to work within personal-brand's /apps/tasks/ routing structure.

    1. **Copy and adapt demo-seed.ts** from `todoist/src/data/demo-seed.ts` to `src/data/demo-seed.ts`:
       - Copy the file verbatim initially
       - Change type imports from `@/generated/prisma/client` and `@/types` to personal-brand equivalents:
         - `import type { Section, Tag } from "@/generated/prisma/client"` (same path, Prisma is installed)
         - `import type { ProjectWithSections, SidebarWorkspace, TaskWithRelations } from "@/lib/tasks/types"`
       - The seed data should include:
         - 2 workspaces ("Personal" and "Work")
         - 4 projects ("Website Redesign", "Mobile App", "Content Strategy", "API Integration")
         - 8 tags (Frontend, Backend, Design, High Priority, Bug Fix, Documentation, Research, Testing)
         - ~40 tasks total with: subtasks, effort scores (1-13), deadlines (past, today, future), descriptions, multiple tags, completed status, sections
       - Export: `DEMO_TAGS`, `DEMO_SIDEBAR_TAGS`, `DEMO_WORKSPACES`, `DEMO_PROJECTS` (Map<string, ProjectWithSections>)

    2. **Create DemoProvider** (`src/components/tasks/demo/DemoProvider.tsx`):
       - Copy from `todoist/src/components/demo/DemoProvider.tsx`
       - Update import paths:
         - `@/data/demo-seed` (same)
         - `@/lib/tasks/types` instead of `@/types`
       - Provides context with: `isDemoMode`, `workspaces`, `projects` (Map), `allTags`, `sidebarTags`

    3. **Create DemoBanner** (`src/components/tasks/demo/DemoBanner.tsx`):
       - Copy from `todoist/src/components/demo/DemoBanner.tsx`
       - Change CTA link from `/tasks` to `/apps/tasks` (the sign-in page for Tasks)
       - Keep: sticky banner, DEMO badge, explanatory text, Sign Up Free CTA button

    4. **Create DemoSidebar** (`src/components/tasks/demo/DemoSidebar.tsx`):
       - Copy from `todoist/src/components/demo/DemoSidebar.tsx`
       - Update all routes from `/demo/...` to `/apps/tasks/demo/...`:
         - Link href `/demo` → `/apps/tasks/demo`
         - Project links `/demo/${project.id}` → `/apps/tasks/demo/${project.id}`
         - Active pathname check `/demo/${project.id}` → `/apps/tasks/demo/${project.id}`
       - Update import paths: `@/components/demo/DemoProvider` → `@/components/tasks/demo/DemoProvider`
       - `cn` import from `@/lib/utils`

    5. Run `npm run lint` to fix any import ordering issues.
  </action>
  <verify>
    - `npm run build` succeeds
    - `npm run lint` passes
    - All four files exist: demo-seed.ts, DemoProvider.tsx, DemoBanner.tsx, DemoSidebar.tsx
  </verify>
  <done>
    Demo seed data with ~40 tasks across 4 projects, DemoProvider context, DemoBanner with /apps/tasks CTA, and DemoSidebar with /apps/tasks/demo navigation all created and building cleanly.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create demo route structure with layout and project views</name>
  <files>
    src/app/apps/tasks/demo/layout.tsx
    src/app/apps/tasks/demo/page.tsx
    src/app/apps/tasks/demo/[projectId]/page.tsx
    src/app/apps/tasks/demo/[projectId]/demo-project-view.tsx
  </files>
  <action>
    Create the demo route pages adapted from the todoist standalone app.

    1. **Create demo layout** (`src/app/apps/tasks/demo/layout.tsx`):
       - Copy from `todoist/src/app/demo/layout.tsx`
       - Mark as `"use client"`
       - Import DemoModeProvider from `@/lib/tasks/demo` (already exists in personal-brand)
       - Import DemoProvider from `@/components/tasks/demo/DemoProvider`
       - Import DemoBanner from `@/components/tasks/demo/DemoBanner`
       - Import DemoSidebar from `@/components/tasks/demo/DemoSidebar`
       - Wrap children in: `DemoModeProvider value={true}` > `DemoProvider` > banner + sidebar + content layout
       - Use same flex h-screen layout pattern as the main Tasks layout
       - IMPORTANT: This layout does NOT go through the main Tasks layout.tsx (it's a separate route group). The `/apps/tasks/demo` route should bypass the authenticated Tasks layout entirely. Verify the Next.js App Router structure: `src/app/apps/tasks/demo/layout.tsx` will be a nested layout INSIDE `src/app/apps/tasks/layout.tsx`. This means the parent layout's auth check will reject unauthenticated users.

       **CRITICAL FIX NEEDED**: The parent `/apps/tasks/layout.tsx` wraps everything in `AuthGuard` which blocks unauthenticated access. The demo route MUST be accessible without auth. To fix this:
       - Move the current `/apps/tasks/layout.tsx` logic into a route group: Create `src/app/apps/tasks/(authenticated)/layout.tsx` with the current auth/billing/sidebar layout
       - Move all authenticated routes into the `(authenticated)` group
       - Create a minimal `src/app/apps/tasks/layout.tsx` that just renders `{children}` (no auth)
       - The demo route at `src/app/apps/tasks/demo/` will then bypass auth entirely

       **Route restructure:**
       ```
       src/app/apps/tasks/
         layout.tsx              -- minimal wrapper (no auth)
         page.tsx                -- landing page (move to (authenticated)/)
         (authenticated)/
           layout.tsx            -- current layout with AuthGuard, BillingProvider, Sidebar
           page.tsx              -- landing page (moved from parent)
           [projectId]/          -- (moved from parent)
           today/                -- (moved from parent)
           completed/            -- (moved from parent)
           search/               -- (moved from parent)
           tags/                 -- (moved from parent)
         demo/
           layout.tsx            -- DemoModeProvider + DemoProvider + DemoBanner + DemoSidebar
           page.tsx              -- redirect to first demo project
           [projectId]/
             page.tsx            -- demo project page
             demo-project-view.tsx -- read-only project view
       ```

    2. **Create demo page** (`src/app/apps/tasks/demo/page.tsx`):
       - Copy from `todoist/src/app/demo/page.tsx`
       - Mark as `"use client"`
       - Redirect to first demo project: `router.replace('/apps/tasks/demo/${firstProjectId}')`
       - Use `useDemoContext()` to get workspaces

    3. **Create demo project page** (`src/app/apps/tasks/demo/[projectId]/page.tsx`):
       - Copy from `todoist/src/app/demo/[projectId]/page.tsx`
       - Mark as `"use client"`
       - Use `useDemoContext()` to get projects and tags
       - Render `DemoProjectView` for the matching project

    4. **Create DemoProjectView** (`src/app/apps/tasks/demo/[projectId]/demo-project-view.tsx`):
       - Copy from `todoist/src/app/demo/[projectId]/demo-project-view.tsx`
       - This is a read-only project view with list/board toggle, DemoTaskCard, DemoSectionHeader, DemoBoardView
       - These are simplified read-only variants that do NOT import server actions or AuthContext
       - Update imports: types from `@/lib/tasks/types`, effort from `@/lib/tasks/effort`
       - All components are purely visual with no mutation capabilities
       - Effort scoring displays at section and project level using `computeEffortSum`

    5. Run `npm run build && npm run lint` to verify everything compiles.
  </action>
  <verify>
    - `npm run build` succeeds
    - `npm run lint` passes
    - All 4 route files exist
    - The demo layout does NOT import AuthGuard or any server-action-dependent components
    - `grep -r "use server" src/app/apps/tasks/demo/` returns no matches (demo is fully client-side)
  </verify>
  <done>
    Complete demo mode route at /apps/tasks/demo with: DemoModeProvider wrapping, DemoBanner sticky banner, DemoSidebar navigation, read-only project views with list/board toggle, and no server-side dependencies. Authenticated routes restructured into (authenticated) route group so demo bypasses auth. Demo prevents all database writes via DemoModeProvider + useDemoMode guards on existing task/subtask/section components.
  </done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `npm run build && npm run lint && npm test` all pass
2. `/apps/tasks/demo` route exists and loads without authentication
3. Authenticated routes at `/apps/tasks`, `/apps/tasks/[projectId]`, etc. still require auth
4. Demo seed data has ~40 tasks across 4 projects with subtasks, tags, effort scores
5. DemoBanner renders with "Sign Up Free" CTA linking to /apps/tasks
6. No `"use server"` directives in demo route tree
7. useDemoMode guards in task-card, subtask-list, section-header prevent mutations
</verification>

<success_criteria>
- Demo mode accessible at /apps/tasks/demo without sign-in
- ~40 realistic sample tasks with subtasks, tags (8 colors), effort scores, deadlines, completed status
- DemoBanner sticky at top with DEMO badge and Sign Up Free CTA
- DemoSidebar shows 2 workspaces with 4 projects
- Read-only project views with list/board toggle
- No database writes possible in demo mode
- All authenticated routes continue to work with auth + billing + sidebar
</success_criteria>

<output>
After completion, create `.planning/phases/47-feature-parity-and-demo-mode/47-03-SUMMARY.md`
</output>
