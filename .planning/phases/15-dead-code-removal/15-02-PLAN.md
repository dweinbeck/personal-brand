---
phase: 15-dead-code-removal
plan: 02
type: execute
wave: 2
depends_on: ["15-01"]
files_modified:
  - src/lib/assistant/analytics.ts (deleted)
  - src/lib/assistant/facts-store.ts (deleted)
  - src/lib/assistant/filters.ts (deleted)
  - src/lib/assistant/gemini.ts (deleted)
  - src/lib/assistant/knowledge.ts (deleted)
  - src/lib/assistant/lead-capture.ts (deleted)
  - src/lib/assistant/logging.ts (deleted)
  - src/lib/assistant/prompt-versions.ts (deleted)
  - src/lib/assistant/prompts.ts (deleted)
  - src/lib/assistant/rate-limit.ts (deleted)
  - src/lib/assistant/refusals.ts (deleted)
  - src/lib/assistant/safety.ts (deleted)
  - src/data/approved-responses.json (deleted)
  - src/data/canon.json (deleted)
  - src/data/contact.json (deleted)
  - src/data/faq.json (deleted)
  - src/data/safety-rules.json (deleted)
  - src/data/services.md (deleted)
  - src/data/writing.json (deleted)
  - src/hooks/useIdToken.ts (deleted)
autonomous: true

must_haves:
  truths:
    - "src/lib/assistant/ contains ONLY fastapi-client.ts (the new code)"
    - "src/data/ contains ONLY projects.json and accomplishments.json (non-assistant data)"
    - "projects.json and accomplishments.json are intact and their consuming pages render correctly"
    - "The site builds and deploys with zero Module not found errors"
    - "useIdToken.ts is removed (zero remaining importers after Plan 01 deleted its consumers)"
  artifacts:
    - path: "src/lib/assistant/fastapi-client.ts"
      provides: "FastAPI typed client"
      contains: "fastApiClient"
    - path: "src/data/projects.json"
      provides: "Project configuration data"
      contains: "projects"
    - path: "src/data/accomplishments.json"
      provides: "Accomplishments data"
      contains: "accomplishments"
  key_links:
    - from: "src/lib/github.ts"
      to: "src/data/projects.json"
      via: "import"
      pattern: "from.*projects\\.json"
    - from: "src/lib/accomplishments.ts"
      to: "src/data/accomplishments.json"
      via: "import"
      pattern: "from.*accomplishments\\.json"
    - from: "src/app/api/assistant/chat/route.ts"
      to: "src/lib/assistant/fastapi-client.ts"
      via: "import"
      pattern: "from.*fastapi-client"
---

<objective>
Delete all old assistant library files, old data files, and the orphaned useIdToken hook.

Purpose: With all consumers removed in Plan 01 (admin pages, routes, components), the 12 old assistant library files and 7 old data files are now fully dead code with zero importers. This plan removes them, leaving src/lib/assistant/ with only the new FastAPI client and src/data/ with only the actively-used projects.json and accomplishments.json.

Output: Clean codebase with no dead assistant code. Build passes. Projects and Accomplishments pages render correctly.
</objective>

<execution_context>
@/Users/dweinbeck/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dweinbeck/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/15-dead-code-removal/15-RESEARCH.md
@.planning/phases/15-dead-code-removal/15-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete old assistant library files</name>
  <files>
    src/lib/assistant/analytics.ts (delete)
    src/lib/assistant/facts-store.ts (delete)
    src/lib/assistant/filters.ts (delete)
    src/lib/assistant/gemini.ts (delete)
    src/lib/assistant/knowledge.ts (delete)
    src/lib/assistant/lead-capture.ts (delete)
    src/lib/assistant/logging.ts (delete)
    src/lib/assistant/prompt-versions.ts (delete)
    src/lib/assistant/prompts.ts (delete)
    src/lib/assistant/rate-limit.ts (delete)
    src/lib/assistant/refusals.ts (delete)
    src/lib/assistant/safety.ts (delete)
  </files>
  <action>
    Delete all 12 old assistant library files from src/lib/assistant/. These files have zero remaining importers (verified in 15-RESEARCH.md dependency graph -- all consumers were deleted in Plan 01).

    Delete each file individually (do NOT rm -rf the directory -- fastapi-client.ts must survive):
    - `rm src/lib/assistant/analytics.ts`
    - `rm src/lib/assistant/facts-store.ts`
    - `rm src/lib/assistant/filters.ts`
    - `rm src/lib/assistant/gemini.ts`
    - `rm src/lib/assistant/knowledge.ts`
    - `rm src/lib/assistant/lead-capture.ts`
    - `rm src/lib/assistant/logging.ts`
    - `rm src/lib/assistant/prompt-versions.ts`
    - `rm src/lib/assistant/prompts.ts`
    - `rm src/lib/assistant/rate-limit.ts`
    - `rm src/lib/assistant/refusals.ts`
    - `rm src/lib/assistant/safety.ts`

    CRITICAL: Do NOT delete `src/lib/assistant/fastapi-client.ts` -- it is the active FastAPI proxy client imported by the chat route handler.

    After deletion, verify: `ls src/lib/assistant/` should show ONLY `fastapi-client.ts`.

    Run `npm run build` to confirm no broken imports.
  </action>
  <verify>
    `ls src/lib/assistant/` shows only `fastapi-client.ts`.
    `npm run build` passes with zero errors.
  </verify>
  <done>
    src/lib/assistant/ contains only fastapi-client.ts. All 12 old library files are deleted. Build passes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Delete old data files and useIdToken hook</name>
  <files>
    src/data/approved-responses.json (delete)
    src/data/canon.json (delete)
    src/data/contact.json (delete)
    src/data/faq.json (delete)
    src/data/safety-rules.json (delete)
    src/data/services.md (delete)
    src/data/writing.json (delete)
    src/hooks/useIdToken.ts (delete)
  </files>
  <action>
    Delete the 7 old assistant data files from src/data/. These were only imported by library files deleted in Task 1 (knowledge.ts, filters.ts, refusals.ts).

    - `rm src/data/approved-responses.json`
    - `rm src/data/canon.json`
    - `rm src/data/contact.json`
    - `rm src/data/faq.json`
    - `rm src/data/safety-rules.json`
    - `rm src/data/services.md`
    - `rm src/data/writing.json`

    CRITICAL: Do NOT delete `src/data/projects.json` (imported by src/lib/github.ts) or `src/data/accomplishments.json` (imported by src/lib/accomplishments.ts). These are non-assistant data files.

    After deletion, verify: `ls src/data/` should show ONLY `accomplishments.json` and `projects.json`.

    Also delete the orphaned useIdToken hook:
    - `rm src/hooks/useIdToken.ts`

    This hook was only imported by FactsEditor.tsx, PromptVersions.tsx, and ReindexButton.tsx -- all deleted in Plan 01. It is a simple 35-line utility that can be recreated from git history if ever needed.

    If the hooks directory is now empty, remove it: `rmdir src/hooks/ 2>/dev/null`

    Run full quality gates: `npm run build && npm run lint && npm test`
  </action>
  <verify>
    `ls src/data/` shows only `accomplishments.json` and `projects.json`.
    `ls src/hooks/ 2>/dev/null` returns nothing (directory removed) OR is empty.
    `npm run build` passes with zero errors.
    `npm run lint` passes with zero errors.
    `npm test` passes.
  </verify>
  <done>
    All 7 old data files deleted. useIdToken.ts deleted. src/data/ contains only projects.json and accomplishments.json. Full quality gates pass. Phase 15 dead code removal is complete.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` -- zero errors
2. `npm run lint` -- zero errors
3. `npm test` -- all tests pass
4. `ls src/lib/assistant/` -- only `fastapi-client.ts`
5. `ls src/data/` -- only `accomplishments.json` and `projects.json`
6. `ls src/hooks/ 2>/dev/null` -- empty or directory gone
7. `grep -r "from \"@/lib/assistant/" src/ | grep -v fastapi-client` -- zero results (no stale imports to deleted files)
8. `grep -r "from \"@/data/" src/` -- shows only projects.json and accomplishments.json imports
</verification>

<success_criteria>
- src/lib/assistant/ contains ONLY fastapi-client.ts
- src/data/ contains ONLY projects.json and accomplishments.json
- useIdToken.ts is removed
- Build, lint, and tests all pass
- No stale imports to any deleted file remain in the codebase
- Projects page and Accomplishments page still render (their data files are preserved)
</success_criteria>

<output>
After completion, create `.planning/phases/15-dead-code-removal/15-02-SUMMARY.md`
</output>
