---
phase: 11-github-api-integration
plan: 03
type: execute
wave: 2
depends_on: ["11-01"]
files_modified:
  - src/components/home/FeaturedProjects.tsx
  - src/components/home/ProjectCard.tsx
autonomous: true

must_haves:
  truths:
    - "Homepage featured projects use same data source as projects page"
    - "Featured projects are filtered by featured: true flag"
    - "Project cards link to individual detail pages"
  artifacts:
    - path: "src/components/home/FeaturedProjects.tsx"
      provides: "Featured projects fetching from GitHub API"
      contains: "fetchAllProjects"
    - path: "src/components/home/ProjectCard.tsx"
      provides: "Project card with detail page link"
      contains: "href"
  key_links:
    - from: "src/components/home/FeaturedProjects.tsx"
      to: "src/lib/github.ts"
      via: "fetchAllProjects import"
      pattern: "import.*fetchAllProjects.*github"
    - from: "src/components/home/ProjectCard.tsx"
      to: "/projects/[slug]"
      via: "Link href"
      pattern: "href.*projects/"
---

<objective>
Unify homepage featured projects with the same data source as the projects page.

Purpose: Deliver PROJ-04 (homepage featured projects use same data source as projects page). Removes duplicate hardcoded data and ensures consistency between homepage and projects page.

Output: FeaturedProjects component fetches from GitHub API and filters by featured flag.
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/11-github-api-integration/11-RESEARCH.md

@src/components/home/FeaturedProjects.tsx
@src/components/home/ProjectCard.tsx
@src/types/project.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update FeaturedProjects to use live GitHub data</name>
  <files>
    - src/components/home/FeaturedProjects.tsx
    - src/components/home/ProjectCard.tsx
  </files>
  <action>
1. Update `src/components/home/ProjectCard.tsx`:
   - Change interface to accept EnrichedProject (or a subset)
   - Add Link wrapper to navigate to `/projects/${project.slug}`
   - Keep existing card styling and status badges
   - Make the entire card clickable (wrap in Link or use anchor)

   ```typescript
   import Link from "next/link";
   import type { EnrichedProject } from "@/types/project";

   interface ProjectCardProps {
     project: EnrichedProject;
   }

   export function ProjectCard({ project }: ProjectCardProps) {
     return (
       <Link href={`/projects/${project.slug}`} className="block">
         <div className="relative rounded-2xl border border-border bg-surface p-8 shadow-[var(--shadow-card)] transition-all duration-200 hover:shadow-[var(--shadow-card-hover)] motion-safe:hover:-translate-y-1 group">
           {/* Status badge */}
           <span className={`absolute top-4 right-4 ...`}>
             {project.status}
           </span>
           {/* ... rest of card */}
         </div>
       </Link>
     );
   }
   ```

2. Update `src/components/home/FeaturedProjects.tsx`:
   - Remove hardcoded `projects` array and `PlaceholderProject` interface
   - Convert to async server component
   - Import `fetchAllProjects` from "@/lib/github"
   - Filter projects by `featured === true`
   - Limit to first 6 featured projects (or all if fewer)

   ```typescript
   import { Button } from "@/components/ui/Button";
   import { ProjectCard } from "./ProjectCard";
   import { fetchAllProjects } from "@/lib/github";

   export async function FeaturedProjects() {
     const allProjects = await fetchAllProjects();
     const featuredProjects = allProjects
       .filter((p) => p.featured)
       .slice(0, 6); // Max 6 on homepage

     return (
       <section className="py-8 motion-safe:animate-fade-in-up">
         <h2 className="text-2xl font-semibold tracking-tight text-text-primary text-center mb-10">
           Featured Projects
         </h2>
         <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
           {featuredProjects.map((project) => (
             <ProjectCard key={project.slug} project={project} />
           ))}
         </div>
         <div className="mt-8 text-center">
           <Button variant="secondary" size="sm" href="/projects">
             See all projects
           </Button>
         </div>
       </section>
     );
   }
   ```

3. Verify homepage still works:
   - Since FeaturedProjects is now async, ensure parent component (homepage) can handle it
   - Next.js App Router supports async server components by default
  </action>
  <verify>
    - `npm run build` passes
    - Visit homepage in dev mode - featured projects section loads
    - Project cards show live data matching projects page
    - Clicking a card navigates to /projects/[slug]
    - Only projects with featured: true appear
  </verify>
  <done>
    - FeaturedProjects fetches from fetchAllProjects()
    - Only featured projects shown (featured: true filter)
    - Project cards are clickable and link to detail pages
    - No more duplicate hardcoded data between homepage and projects page
  </done>
</task>

<task type="auto">
  <name>Task 2: Update sitemap for new project detail routes</name>
  <files>src/app/sitemap.ts</files>
  <action>
Update `src/app/sitemap.ts` to include project detail pages:

1. Import fetchAllProjects from "@/lib/github"
2. Add project detail URLs to the sitemap

```typescript
import { fetchAllProjects } from "@/lib/github";

export default async function sitemap(): Promise<MetadataRoute.Sitemap> {
  const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || "https://dan-weinbeck.com";

  // Fetch projects for dynamic routes
  const projects = await fetchAllProjects();
  const projectUrls = projects.map((p) => ({
    url: `${baseUrl}/projects/${p.slug}`,
    lastModified: p.pushedAt ? new Date(p.pushedAt) : new Date(),
    changeFrequency: "weekly" as const,
    priority: 0.7,
  }));

  return [
    // ... existing static routes
    ...projectUrls,
  ];
}
```

This ensures search engines can discover all project detail pages.
  </action>
  <verify>
    - `npm run build` passes
    - Check generated sitemap includes /projects/[slug] URLs
  </verify>
  <done>
    - Sitemap includes all project detail page URLs
    - lastModified uses pushedAt from GitHub API
  </done>
</task>

</tasks>

<verification>
After completing all tasks:
1. Run `npm run build` - should succeed
2. Run `npm run dev` and test:
   - Homepage shows featured projects with live data
   - Clicking project card navigates to detail page
   - Data matches projects page (same source)
3. Check sitemap at /sitemap.xml includes project detail URLs
</verification>

<success_criteria>
- Homepage featured projects fetch from same fetchAllProjects() as projects page
- Only projects with featured: true appear on homepage
- Project cards link to /projects/[slug]
- Sitemap includes all project detail page URLs
- No duplicate hardcoded project data anywhere
</success_criteria>

<output>
After completion, create `.planning/phases/11-github-api-integration/11-03-SUMMARY.md`
</output>
