---
phase: 47-feature-parity-and-demo-mode
plan: 04
type: execute
wave: 2
depends_on: [47-01, 47-02, 47-03]
files_modified:
  - src/app/apps/tasks/demo/layout.tsx
  - src/app/apps/tasks/demo/page.tsx
  - src/components/tasks/auth/AuthGuard.tsx
autonomous: false
requirements: [FP-01, FP-02, FP-03, FP-04, FP-05, FP-06, FP-07, FP-08, FP-09, FP-10, DM-01, DM-02, DM-03, DM-04]

must_haves:
  truths:
    - "All 14 requirements pass end-to-end verification"
    - "Authenticated /apps/tasks features match standalone todoist app functionality"
    - "Demo mode at /apps/tasks/demo is fully functional without sign-in"
    - "No regressions in existing site features (build, lint, test all pass)"
  artifacts:
    - path: "src/app/apps/tasks/demo/layout.tsx"
      provides: "Verified demo layout bypassing auth"
    - path: "src/components/tasks/auth/AuthGuard.tsx"
      provides: "Try the demo link pointing to /apps/tasks/demo"
  key_links:
    - from: "src/components/tasks/auth/AuthGuard.tsx"
      to: "/apps/tasks/demo"
      via: "Link href"
      pattern: "/apps/tasks/demo"
    - from: "src/app/apps/tasks/demo/layout.tsx"
      to: "src/lib/tasks/demo.ts"
      via: "DemoModeProvider"
      pattern: "DemoModeProvider"
---

<objective>
End-to-end verification of all Phase 47 features with final integration fixes. Verify every requirement is met and fix any remaining issues discovered during testing.

Purpose: Ensure all 14 requirements (FP-01 through FP-10 and DM-01 through DM-04) are fully satisfied before marking Phase 47 complete.
Output: All features verified working, any remaining issues fixed, phase ready for Phase 48 (Decommission).
</objective>

<execution_context>
@/Users/dweinbeck/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dweinbeck/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/47-feature-parity-and-demo-mode/47-01-SUMMARY.md
@.planning/phases/47-feature-parity-and-demo-mode/47-02-SUMMARY.md
@.planning/phases/47-feature-parity-and-demo-mode/47-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: End-to-end requirement verification and integration fixes</name>
  <files>
    src/app/apps/tasks/demo/layout.tsx
    src/app/apps/tasks/demo/page.tsx
    src/components/tasks/auth/AuthGuard.tsx
  </files>
  <action>
    Systematically verify each of the 14 requirements. For each requirement, check the code chain from UI to service layer. Fix any remaining issues.

    **Feature Parity Verification Checklist:**

    FP-01: Project detail view works with list and board view modes
    - Verify: `src/app/apps/tasks/[projectId]/project-view.tsx` has list/board toggle
    - Check: `updateProjectViewModeAction` in actions, service function exists

    FP-02: Task CRUD (create, edit, delete, toggle) works from all views
    - Verify: TaskCard has toggle + delete, TaskForm has create + edit
    - Check: All four action functions exist and call proper service methods

    FP-03: Subtask support (create, toggle, delete)
    - Verify: SubtaskList component has create, toggle, delete functionality
    - Check: `createSubtaskAction`, `toggleTaskAction`, `deleteTaskAction` work for subtasks

    FP-04: Tag management (create, assign, filter by tag)
    - Verify: TagList has create/delete, TaskForm has tag selector, tag detail page filters
    - Check: Full chain from UI to tag service

    FP-05: Effort scoring displays and updates correctly
    - Verify: TaskCard shows effort badge, project-view shows section/project effort totals
    - Check: `computeEffortSum` is used correctly, effort field in task form

    FP-06: Today view filters tasks by deadline
    - Verify: today/page.tsx calls getTasksForToday which queries by deadline date range

    FP-07: Completed view shows completed tasks
    - Verify: completed/page.tsx calls getCompletedTasks, CompletedView has project filter

    FP-08: Search functionality works
    - Verify: search/page.tsx calls searchTasks with query, SearchInput navigates correctly

    FP-09: Quick-add modal creates tasks from any page
    - Verify: QuickAddModal in sidebar opens, receives workspaces/tags, calls createTaskAction

    FP-10: Help tips display correctly
    - Verify: HelpTip component exists, data catalog has 8 entries, 5+ placements in components

    **Demo Mode Verification Checklist:**

    DM-01: Demo at /apps/tasks/demo with in-memory data (no database)
    - Verify: Demo route exists, layout uses DemoProvider with seed data, no Prisma imports in demo tree

    DM-02: Demo banner with sign-up CTA
    - Verify: DemoBanner renders in demo layout, CTA links to /apps/tasks

    DM-03: ~40 realistic sample tasks with all features
    - Verify: demo-seed.ts has ~40 tasks, includes subtasks, tags, effort scores, deadlines, completed

    DM-04: Demo prevents database writes
    - Verify: DemoModeProvider wraps demo layout with value={true}
    - Check: useDemoMode() returns true in demo, guards in task-card/subtask-list/section-header prevent mutations

    **Cross-cutting verification:**
    - Verify AuthGuard "try the demo" link points to `/apps/tasks/demo`
    - Run `npm run build && npm run lint && npm test` -- all must pass
    - Verify no console.log or debugger statements in new/modified files
    - Verify no placeholder data or example.com references in production code

    **Fix any issues found during verification.** Common issues to look for:
    - Missing `"use client"` directive on components using hooks
    - Wrong path in `revalidatePath` calls (must be `/apps/tasks`)
    - Missing Prisma includes in service queries
    - Demo routes importing server-only modules
    - Broken links (wrong prefix)
  </action>
  <verify>
    - `npm run build` succeeds with zero errors
    - `npm run lint` passes
    - `npm test` passes all tests
    - Verification checklist above: all 14 items confirmed
  </verify>
  <done>
    All 14 Phase 47 requirements verified working. Build, lint, and test all pass. No integration issues remaining.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Manual verification of all features and demo mode</name>
  <action>
    User manually verifies all Phase 47 features work correctly in the browser.

    **What was built:**

    Authenticated features (sign in required):
    - Project detail view with list/board toggle at /apps/tasks/[projectId]
    - Task CRUD: create, edit, delete, toggle status
    - Subtasks: create, toggle, delete within parent tasks
    - Tags: create tags, assign to tasks, filter by tag at /apps/tasks/tags/[tagId]
    - Effort scoring: displays on tasks, totals on sections/projects
    - Today view at /apps/tasks/today (tasks due today)
    - Completed view at /apps/tasks/completed (with project filter)
    - Search at /apps/tasks/search
    - Quick-add from sidebar
    - Help tips (gold ? icons) next to key UI elements

    Demo mode (no sign-in required):
    - Visit /apps/tasks/demo to see demo workspace
    - ~40 sample tasks across 4 projects with subtasks, tags, effort scores
    - DEMO banner at top with "Sign Up Free" CTA
    - Read-only: toggle/edit/delete buttons hidden or inert
    - Sidebar shows demo workspaces/projects

    **How to verify:**
    1. Run `npm run dev` and open http://localhost:3000/apps/tasks
    2. Demo mode (unauthenticated): Visit /apps/tasks/demo, verify banner, click through projects, check list/board toggle, verify edit/delete hidden
    3. Authenticated features: Sign in, open a project, test CRUD, subtasks, tags, Today/Completed/Search views, Quick-add, help tips
    4. Verify site still works overall
  </action>
  <verify>User confirms all features work by typing "approved"</verify>
  <done>All 14 Phase 47 requirements verified by human testing. Phase 47 approved for completion.</done>
</task>

</tasks>

<verification>
Full quality gate check:
1. `npm run build && npm run lint && npm test` all pass
2. Human verification confirms all features work as described
3. No regressions in existing site functionality
</verification>

<success_criteria>
- All 14 requirements (FP-01 through FP-10, DM-01 through DM-04) verified working
- Build, lint, and test pass
- Human verification approved
- Phase 47 ready for completion, Phase 48 can begin
</success_criteria>

<output>
After completion, create `.planning/phases/47-feature-parity-and-demo-mode/47-04-SUMMARY.md`
</output>
