---
phase: 35-demo-workspace
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - /Users/dweinbeck/Documents/todoist/src/data/demo-seed.ts
  - /Users/dweinbeck/Documents/todoist/src/lib/demo.ts
  - /Users/dweinbeck/Documents/todoist/src/components/demo/DemoProvider.tsx
  - /Users/dweinbeck/Documents/todoist/src/components/demo/DemoSidebar.tsx
  - /Users/dweinbeck/Documents/todoist/src/app/demo/layout.tsx
  - /Users/dweinbeck/Documents/todoist/src/app/demo/page.tsx
  - /Users/dweinbeck/Documents/todoist/src/app/demo/[projectId]/page.tsx
  - /Users/dweinbeck/Documents/todoist/src/app/demo/[projectId]/demo-project-view.tsx
autonomous: true

must_haves:
  truths:
    - "Unauthenticated visitor can navigate to /demo and see a sidebar with 4 projects across 2 workspaces"
    - "Visitor can click a project in the demo sidebar and see 8-15 realistic tasks with effort scores, tags, subtasks, deadlines, and sections"
    - "Demo workspace renders entirely client-side with zero server imports (no @/lib/auth, @/services/, @/actions/, @/lib/db)"
    - "Demo seed data includes ~40 tasks covering all feature variants: effort scores (1,2,3,5,8,13 and null), deadlines (future, overdue, null), subtasks (mixed statuses), tags, sections, completed tasks, descriptions"
  artifacts:
    - path: "src/data/demo-seed.ts"
      provides: "Static seed data (~40 tasks, 4 projects, 2 workspaces, 8 tags)"
      contains: "DEMO_WORKSPACES"
    - path: "src/lib/demo.ts"
      provides: "useDemoMode hook and DemoModeProvider context"
      exports: ["useDemoMode", "DemoModeProvider"]
    - path: "src/components/demo/DemoProvider.tsx"
      provides: "Context provider wrapping demo routes with seed data"
      exports: ["DemoProvider", "useDemoContext"]
    - path: "src/components/demo/DemoSidebar.tsx"
      provides: "Read-only sidebar for demo with workspace/project navigation"
      exports: ["DemoSidebar"]
    - path: "src/app/demo/layout.tsx"
      provides: "Client-side demo layout with DemoProvider and DemoSidebar"
    - path: "src/app/demo/[projectId]/page.tsx"
      provides: "Demo project page reading from DemoContext"
    - path: "src/app/demo/[projectId]/demo-project-view.tsx"
      provides: "Client-side project view with list/board toggle, no mutations"
  key_links:
    - from: "src/app/demo/layout.tsx"
      to: "src/components/demo/DemoProvider.tsx"
      via: "wraps children in DemoProvider + DemoModeProvider"
      pattern: "DemoProvider|DemoModeProvider"
    - from: "src/app/demo/[projectId]/page.tsx"
      to: "src/components/demo/DemoProvider.tsx"
      via: "useDemoContext() to get project data by ID"
      pattern: "useDemoContext"
    - from: "src/components/demo/DemoSidebar.tsx"
      to: "src/components/demo/DemoProvider.tsx"
      via: "useDemoContext() for workspace/project navigation data"
      pattern: "useDemoContext"
    - from: "src/components/demo/DemoProvider.tsx"
      to: "src/data/demo-seed.ts"
      via: "imports static seed data constants"
      pattern: "DEMO_WORKSPACES|DEMO_PROJECTS|DEMO_TAGS"
---

<objective>
Create the demo workspace foundation: static seed data (~40 realistic tasks across 4 projects in 2 workspaces), DemoProvider context, demo route structure at `/demo`, read-only DemoSidebar, and DemoProjectView.

Purpose: Enables unauthenticated visitors to browse a realistic pre-populated workspace that showcases effort scores, subtasks, tags, deadlines, sections, and multiple project structures -- all running entirely client-side with zero database writes or API calls.

Output: Working `/demo` route with sidebar navigation between 4 demo projects, each rendering tasks in list and board views.
</objective>

<execution_context>
@/Users/dweinbeck/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dweinbeck/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@/Users/dweinbeck/Documents/personal-brand/.planning/PROJECT.md
@/Users/dweinbeck/Documents/personal-brand/.planning/ROADMAP.md
@/Users/dweinbeck/Documents/personal-brand/.planning/STATE.md
@/Users/dweinbeck/Documents/personal-brand/.planning/phases/35-demo-workspace/35-RESEARCH.md

NOTE: This plan executes in the todoist repo at /Users/dweinbeck/Documents/todoist

Key codebase references (read these for type shapes and patterns):
@/Users/dweinbeck/Documents/todoist/src/types/index.ts
@/Users/dweinbeck/Documents/todoist/prisma/schema.prisma
@/Users/dweinbeck/Documents/todoist/src/app/tasks/layout.tsx
@/Users/dweinbeck/Documents/todoist/src/app/tasks/[projectId]/project-view.tsx
@/Users/dweinbeck/Documents/todoist/src/components/tasks/sidebar.tsx
@/Users/dweinbeck/Documents/todoist/src/components/tasks/board-view.tsx
@/Users/dweinbeck/Documents/todoist/src/components/tasks/task-card.tsx
@/Users/dweinbeck/Documents/todoist/src/lib/effort.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create demo seed data and demo mode hook</name>
  <files>
    /Users/dweinbeck/Documents/todoist/src/data/demo-seed.ts
    /Users/dweinbeck/Documents/todoist/src/lib/demo.ts
  </files>
  <action>
**File 1: `src/lib/demo.ts`** -- Create the demo mode context and hook.
```typescript
"use client";
import { createContext, useContext } from "react";
const DemoModeContext = createContext<boolean>(false);
export const DemoModeProvider = DemoModeContext.Provider;
export function useDemoMode(): boolean {
  return useContext(DemoModeContext);
}
```

**File 2: `src/data/demo-seed.ts`** -- Create static seed data that exactly matches the Prisma-derived types from `@/types` (`TaskWithRelations`, `ProjectWithSections`, `SidebarWorkspace`). Every field from the Prisma models must be present (including `createdAt`, `updatedAt`, `order`, `userId`, `projectId`, `sectionId`, `parentTaskId`, `workspaceId`, etc.) to prevent runtime crashes.

Use deterministic IDs with `demo-` prefix for URL routing (e.g., `demo-proj-1`, `demo-task-1`).

**Seed data structure (~40 tasks across 4 projects in 2 workspaces):**

**Tags (8 tags):**
| Name | Color |
|------|-------|
| Frontend | #3b82f6 |
| Backend | #10b981 |
| Design | #8b5cf6 |
| High Priority | #ef4444 |
| Bug Fix | #f97316 |
| Documentation | #6b7280 |
| Research | #14b8a6 |
| Testing | #eab308 |

**Workspace 1: "Product Launch"** (3 projects)

*Project 1: "Website Redesign" (12-15 tasks, 3 sections: Design, Development, QA)*
- Showcase: sections with effort rollups, board view readiness, overdue deadlines, subtasks, descriptions
- Include tasks with effort 1, 2, 3, 5, 8, 13 (at least one each across all projects)
- Include 1-2 tasks with subtasks (mix of COMPLETED and OPEN subtasks)
- Include 1-2 COMPLETED tasks (to show strikethrough)
- Include 1 task with overdue deadline, 2 with future deadlines, rest without
- Include tasks with 1-3 tags and tasks with no tags
- Include 2-3 tasks with descriptions and rest without

*Project 2: "Marketing Campaign" (8-10 tasks, 2 sections: Content, Distribution)*
- Showcase: tags (Content-related tasks tagged), mixed effort levels, some completed
- Include 2-3 COMPLETED tasks
- Include tasks with no effort (null) to show unscored state

*Project 3: "Launch Checklist" (5-8 tasks, NO sections -- flat list)*
- Showcase: unsectioned flat task list, deadlines, high effort tasks
- All tasks unsectioned (project.tasks, not section.tasks)
- Include 2-3 tasks with deadlines

**Workspace 2: "Personal"** (1 project)

*Project 4: "Learning Goals" (8-10 tasks, 2 sections: Reading, Courses)*
- Showcase: different domain, lower effort tasks, subtasks as chapters/modules
- Include 2-3 tasks with subtasks (e.g., "Read Clean Code" with chapter subtasks)
- Include tasks without any tags

**Date handling:** Use relative dates computed from `Date.now()` so they always look current:
- `const now = new Date()`
- Past dates for `createdAt`/`updatedAt` (1-4 weeks ago)
- Overdue deadlines: a few days ago
- Future deadlines: 1-2 weeks ahead

**Exports:**
- `DEMO_TAGS: { id: string; name: string; color: string | null; userId: string }[]`
- `DEMO_SIDEBAR_TAGS: { id: string; name: string; color: string | null }[]` (without userId, for sidebar)
- `DEMO_WORKSPACES: SidebarWorkspace[]` (for sidebar navigation)
- `DEMO_PROJECTS: Map<string, ProjectWithSections>` (keyed by project ID)

**Critical type compliance:** Import `TaskWithRelations`, `ProjectWithSections`, `SidebarWorkspace` from `@/types` and type-annotate all data to catch missing fields at compile time. The `Task` base type from Prisma includes: `id`, `userId`, `projectId`, `sectionId` (nullable), `parentTaskId` (nullable), `name`, `description` (nullable), `deadlineAt` (nullable), `status`, `effort` (nullable Int), `order` (Float), `createdAt`, `updatedAt`. The `tags` field is `{ tag: Tag }[]` where `Tag` has `id`, `userId`, `name`, `color` (nullable). Subtasks are `Task[]` (same shape, but `subtasks` array is empty and `tags` array is empty for subtasks).

The `Section` type has: `id`, `projectId`, `name`, `order` (Float), `createdAt`, `updatedAt`.
The `Project` type has: `id`, `workspaceId`, `name`, `createdAt`, `updatedAt`.

For `ProjectWithSections`, `sections` is `(Section & { tasks: TaskWithRelations[] })[]` and `tasks` is `TaskWithRelations[]` (unsectioned tasks only -- tasks where `sectionId` is null).

The file will be ~300-400 lines. Use helper functions to reduce repetition (e.g., `makeTask()`, `makeSection()`).
  </action>
  <verify>
Run `cd /Users/dweinbeck/Documents/todoist && npx tsc --noEmit` -- zero type errors. The typed seed data must compile against the Prisma-derived types with no `as any` casts or missing fields.
  </verify>
  <done>
`src/data/demo-seed.ts` exports `DEMO_TAGS`, `DEMO_SIDEBAR_TAGS`, `DEMO_WORKSPACES`, and `DEMO_PROJECTS` (Map of 4 projects with ~40 total tasks). `src/lib/demo.ts` exports `useDemoMode` and `DemoModeProvider`. Both compile with zero type errors.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create demo route structure, DemoProvider, DemoSidebar, and DemoProjectView</name>
  <files>
    /Users/dweinbeck/Documents/todoist/src/components/demo/DemoProvider.tsx
    /Users/dweinbeck/Documents/todoist/src/components/demo/DemoSidebar.tsx
    /Users/dweinbeck/Documents/todoist/src/app/demo/layout.tsx
    /Users/dweinbeck/Documents/todoist/src/app/demo/page.tsx
    /Users/dweinbeck/Documents/todoist/src/app/demo/[projectId]/page.tsx
    /Users/dweinbeck/Documents/todoist/src/app/demo/[projectId]/demo-project-view.tsx
  </files>
  <action>
**All files must be `"use client"` components. ZERO imports from `@/lib/auth`, `@/services/`, `@/actions/`, `@/lib/db`, or any `server-only` module.**

**File 1: `src/components/demo/DemoProvider.tsx`**
- Create a React context providing demo seed data: `isDemoMode: true`, `workspaces: SidebarWorkspace[]`, `projects: Map<string, ProjectWithSections>`, `allTags` array, `sidebarTags` array.
- Import seed data from `@/data/demo-seed`.
- Export `DemoProvider` component and `useDemoContext()` hook.
- Throw an error if `useDemoContext()` is called outside the provider.

**File 2: `src/components/demo/DemoSidebar.tsx`** (~100 lines)
- Simplified read-only sidebar mirroring the visual structure of the existing Sidebar but with NO mutation UI (no "Add Task" button, no add workspace/project buttons, no delete buttons, no QuickAddModal).
- Use `useDemoContext()` to get workspaces.
- Navigation links point to `/demo/[projectId]` (not `/tasks/[projectId]`).
- Nav items at top: just project list (skip Today, Completed, Search, Tags for demo scope).
- Highlight active project using `usePathname()`.
- Show `openTaskCount` badge next to each project name.
- Include the "Todoist" brand link at top pointing to `/demo`.
- Use the same Tailwind classes as the existing Sidebar for visual consistency (w-64, bg-surface, border-r, etc.).

**File 3: `src/app/demo/layout.tsx`**
- Client component wrapping children in `DemoModeProvider value={true}` and `DemoProvider`.
- Structure: `<DemoModeProvider value={true}><DemoProvider><div className="flex flex-col h-screen"><div className="flex flex-1 overflow-hidden"><DemoSidebar /><main className="flex-1 overflow-y-auto">{children}</main></div></div></DemoProvider></DemoModeProvider>`
- NOTE: Leave space above the flex container for the DemoBanner (Plan 02 will add it). For now, just the sidebar+main structure.
- NO AuthGuard, NO BillingProvider, NO server-side data fetching.

**File 4: `src/app/demo/page.tsx`**
- Client component that redirects to the first demo project using `useEffect` + `useRouter` from `next/navigation`.
- Get first project ID from `useDemoContext()`: `const { workspaces } = useDemoContext(); const firstProjectId = workspaces[0]?.projects[0]?.id;`
- If `firstProjectId` exists, `router.replace(\`/demo/${firstProjectId}\`)`.
- While redirecting, show a brief loading state matching the app's style.

**File 5: `src/app/demo/[projectId]/page.tsx`**
- Client component using `use()` from React to unwrap `params` Promise (Next.js 16 pattern: `const { projectId } = use(params)`).
- Get project data from `useDemoContext()`: `const project = projects.get(projectId)`.
- If project not found, show a "Project not found" message (not a crash).
- Pass `project`, `allTags`, and computed `sections` array to `DemoProjectView`.

**File 6: `src/app/demo/[projectId]/demo-project-view.tsx`**
- Client component that mirrors `ProjectView` from `/tasks/[projectId]/project-view.tsx` but with ALL mutations removed:
  - Project name is rendered as a heading (not a clickable rename button)
  - Effort rollups displayed at section and project level (using `computeEffortSum` from `@/lib/effort`)
  - List/board view toggle works (state-only, no server calls)
  - In list view: render `TaskCard` for each task, `SectionHeader` for each section, but NO `AddTaskButton`, NO `AddSectionButton`
  - In board view: render columns with tasks but NO add task buttons, NO add section button
  - Import `TaskCard` and `SectionHeader` from `@/components/tasks/` -- these will be guarded for demo mode in Plan 02. For now, they render but mutations will crash if clicked (acceptable for Plan 01; Plan 02 adds guards).
- Accept props: `project: ProjectWithSections`, `allTags`, `sections`.
- Use `computeEffortSum` from `@/lib/effort` for effort rollups.

**Important:** The demo project view should NOT render `AddTaskButton` or `AddSectionButton` at all (hide them completely rather than showing disabled buttons). This is cleaner than trying to disable complex form-opening components.
  </action>
  <verify>
1. Run `cd /Users/dweinbeck/Documents/todoist && npx tsc --noEmit` -- zero type errors.
2. Run `cd /Users/dweinbeck/Documents/todoist && npm run build` -- build succeeds with no errors.
3. Run `cd /Users/dweinbeck/Documents/todoist && npm run lint` -- no lint errors.
  </verify>
  <done>
Navigating to `/demo` redirects to `/demo/demo-proj-1`. The demo sidebar shows 2 workspaces with 4 projects. Clicking any project renders its tasks in list view with effort rollups, tags, deadlines, and subtask counts visible. Board view toggle works. No mutation buttons (Add Task, Add Section) appear in the demo project view. All client-side, zero server imports.
  </done>
</task>

</tasks>

<verification>
1. `cd /Users/dweinbeck/Documents/todoist && npx tsc --noEmit` -- zero type errors
2. `cd /Users/dweinbeck/Documents/todoist && npm run build` -- build succeeds
3. `cd /Users/dweinbeck/Documents/todoist && npm run lint` -- no lint errors
4. `cd /Users/dweinbeck/Documents/todoist && npm test` -- all existing tests pass
5. Grep for server-only imports in demo routes: `grep -r "from.*@/lib/auth\|from.*@/services\|from.*@/actions\|from.*@/lib/db\|server-only" src/app/demo/ src/components/demo/` -- zero matches
</verification>

<success_criteria>
- `/demo` route exists and redirects to first demo project
- Demo sidebar shows 2 workspaces, 4 projects with task counts
- Each demo project renders tasks with effort scores, tags, deadlines, subtask counts, sections
- Seed data covers all feature variants (effort 1-13 + null, deadlines + overdue + null, subtasks, tags, completed tasks, descriptions, sectioned + unsectioned)
- List and board view toggle works
- Zero server-side imports in demo route tree
- Build, lint, and type-check all pass
</success_criteria>

<output>
After completion, create `.planning/phases/35-demo-workspace/35-01-SUMMARY.md`
</output>
