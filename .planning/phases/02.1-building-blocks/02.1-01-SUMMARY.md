---
phase: 02.1-building-blocks
plan: 01
subsystem: infra
tags: [mdx, next-mdx, tailwind-typography, remark-gfm, rehype-pretty-code, shiki]

# Dependency graph
requires:
  - phase: 01-scaffold
    provides: Next.js project with Tailwind v4 CSS-first config and navigation
provides:
  - MDX compilation pipeline via @next/mdx with createMDX wrapper
  - Tailwind typography plugin for prose styling
  - Building Blocks navigation link
affects: [02.1-building-blocks plan 02, all future tutorial/MDX content pages]

# Tech tracking
tech-stack:
  added: [@next/mdx, @mdx-js/loader, @mdx-js/react, @types/mdx, @tailwindcss/typography, remark-gfm, rehype-pretty-code, shiki]
  patterns: [string plugin names in createMDX for Turbopack serialization compatibility]

key-files:
  created: [mdx-components.tsx]
  modified: [next.config.ts, src/app/globals.css, tsconfig.json, src/components/layout/NavLinks.tsx, package.json]

key-decisions:
  - "Use string plugin names in createMDX options for Turbopack serialization compatibility"
  - "Reduce desktop nav padding from px-3 to px-2 to accommodate 6 links without wrapping"

patterns-established:
  - "MDX plugins as strings: Pass remark/rehype plugins as string names (not imports) in next.config.ts for Turbopack compatibility"

# Metrics
duration: 3min
completed: 2026-02-02
---

# Phase 2.1 Plan 01: MDX Pipeline and Typography Summary

**MDX compilation via @next/mdx with remark-gfm and rehype-pretty-code, Tailwind typography plugin, and Building Blocks nav link**

## Performance

- **Duration:** 3 min
- **Started:** 2026-02-02T13:26:17Z
- **Completed:** 2026-02-02T13:29:17Z
- **Tasks:** 2
- **Files modified:** 6

## Accomplishments
- Full MDX compilation pipeline with createMDX wrapper, remark-gfm for tables/strikethrough, and rehype-pretty-code for syntax highlighting
- Tailwind typography plugin registered for prose styling of rendered MDX content
- Building Blocks link added to site navigation between Projects and Writing

## Task Commits

Each task was committed atomically:

1. **Task 1: Install MDX packages and configure Next.js + Tailwind** - `35b8e5f` (feat)
2. **Task 2: Add Building Blocks link to navigation** - `dc5917a` (feat)

## Files Created/Modified
- `mdx-components.tsx` - Root-level MDX component overrides required by @next/mdx
- `next.config.ts` - Wrapped with createMDX, added pageExtensions for mdx/md files
- `src/app/globals.css` - Added @plugin "@tailwindcss/typography" for prose styling
- `tsconfig.json` - Added **/*.mdx to include array for TypeScript recognition
- `src/components/layout/NavLinks.tsx` - Added Building Blocks link, reduced desktop padding
- `package.json` - Added 8 MDX and typography dependencies

## Decisions Made
- Used string plugin names ("remark-gfm", "rehype-pretty-code") instead of imported functions in createMDX options because Next.js 16 Turbopack requires serializable loader options; imported ESM modules are Module objects and fail serialization
- Reduced desktop nav link padding from px-3 to px-2 to prevent wrapping with 6 navigation items at md breakpoint

## Deviations from Plan

### Auto-fixed Issues

**1. [Rule 3 - Blocking] Turbopack serialization error with imported MDX plugins**
- **Found during:** Task 1 (MDX configuration)
- **Issue:** Next.js 16 Turbopack requires serializable options for loaders; importing remark-gfm and rehype-pretty-code as ESM modules produces non-serializable Module objects, causing build failure
- **Fix:** Changed from `import remarkGfm from "remark-gfm"` with function references to string plugin names `"remark-gfm"` and `["rehype-pretty-code", { theme: "github-light" }]`
- **Files modified:** next.config.ts
- **Verification:** npm run build passes cleanly
- **Committed in:** 35b8e5f (Task 1 commit)

---

**Total deviations:** 1 auto-fixed (1 blocking)
**Impact on plan:** Plugin configuration syntax changed for Turbopack compatibility. No scope creep.

## Issues Encountered
None beyond the Turbopack serialization issue documented above.

## User Setup Required
None - no external service configuration required.

## Next Phase Readiness
- MDX pipeline is configured and build-verified
- Typography plugin registered for prose styling
- Navigation updated with Building Blocks link
- Ready for plan 02: tutorial page layout and first MDX content

---
*Phase: 02.1-building-blocks*
*Completed: 2026-02-02*
