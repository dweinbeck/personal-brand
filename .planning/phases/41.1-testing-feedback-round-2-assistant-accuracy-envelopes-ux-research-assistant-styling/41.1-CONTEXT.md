# Phase 41.1: Testing Feedback Round 2 — Assistant accuracy, Envelopes UX, Research Assistant styling - Context

**Gathered:** 2026-02-17
**Status:** Ready for planning

<domain>
## Phase Boundary

Fix 8 user-reported bugs and UX issues across three feature areas: AI Assistant (accuracy + UI), Envelopes (budget editing + transfer modal + button layout), and Research Assistant (color styling + session history + conversation loading). All items come from TESTING-REVIEW.md round 2 feedback.

</domain>

<decisions>
## Implementation Decisions

### Envelopes — Budget Editing
- Rename "Edit Cards" button to "Edit Envelopes"
- When in edit mode, each card's budget value becomes an inline input field (not a form popup)
- On blur (click elsewhere), the new budget saves immediately
- Target savings on top (disposable income minus total budgets) recalculates live as budgets change

### Envelopes — Transfer Modal
- Show "total available" balance (effective budget including rollover surplus) next to each envelope in the target dropdown
- Remove the optional note/reason field entirely — modal has only: source envelope, target envelope, amount, Transfer button

### Envelopes — Button Layout
- Place "Edit Envelopes", "Transfer Funds", and "Add Transaction" buttons on the same horizontal line after "Week of..." text
- On mobile: stack buttons vertically (single column)
- On desktop: horizontal row

### Research Assistant — Color Fix
- Remove `prose prose-invert` from ResponseDisplay body — use standard site text colors (dark text on light background)
- Keep dark blue (bg-primary) header bar on response panels — only fix the body content area
- Markdown content should use the site's standard prose styling for headings, lists, code blocks, etc.

### Research Assistant — Session History
- Do NOT show "Previous in this session" after only 1 query (avoids duplicate display)
- After 2+ queries in the same conversation, show prior exchanges as a conversation thread
- Follow-up questions append to the thread — all prior exchanges remain visible
- This section shows exchanges from the current conversation only, not different conversations

### Research Assistant — Conversation History Loading
- Clicking a sidebar conversation entry fully restores: original prompt, both model responses, and any follow-up exchanges
- User can continue asking follow-up questions as if they never left
- When loaded, scroll to the bottom (latest exchange) — user scrolls up for history

### AI Assistant — Accuracy
- Audit the knowledge base files in src/data/ to remove stale or incorrect information
- Data should only reflect what is currently published and live on the site
- Produce a documentation file at docs/KNOWLEDGE-BASE.md explaining how the KB works, how it gets updated, and when

### AI Assistant — Chat Input
- Remove the "Press Enter..." instruction text at the bottom of the chat interface completely
- No placeholder text in the input field — completely clean input area with just the text field and send button

### Claude's Discretion
- Exact inline input styling for budget editing on envelope cards
- How to handle validation on budget input (min/max, non-numeric input)
- Responsive breakpoint for button stacking on mobile
- Prose class configuration for Research Assistant body text
- Backend implementation details for conversation history data fetching
- Knowledge base audit specifics (which files to update/remove)

</decisions>

<specifics>
## Specific Ideas

- Budget editing should feel instant — blur triggers save, no save button needed
- Transfer modal should be minimal: "I just need to pick source, target, amount, and go"
- Research Assistant conversation thread should feel like a chat — latest at bottom, scroll up for history
- Knowledge base doc should explain the full pipeline so Dan can understand and maintain it independently

</specifics>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope

</deferred>

---

*Phase: 41.1-testing-feedback-round-2-assistant-accuracy-envelopes-ux-research-assistant-styling*
*Context gathered: 2026-02-17*
