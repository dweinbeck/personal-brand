---
phase: 48-decommission
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: []
autonomous: false
requirements: [DC-01, DC-02, DC-03]

must_haves:
  truths:
    - "The standalone Tasks Cloud Run service no longer exists in the GCP dev project"
    - "The tasks-deploy-dev Cloud Build trigger no longer exists"
    - "The tasks subdomain DNS record is removed or redirects to /apps/tasks"
  artifacts: []
  key_links: []
---

<objective>
Delete the standalone Tasks Cloud Run service, its Cloud Build trigger, and remove or redirect the tasks subdomain DNS record.

Purpose: The Tasks app is now fully integrated into the personal-brand app at /apps/tasks. The standalone todoist Cloud Run service, its deployment pipeline, and its subdomain are no longer needed and should be removed to avoid confusion, reduce costs, and prevent stale traffic.

Output: GCP infrastructure cleaned up -- no Tasks Cloud Run service, no tasks-deploy-dev trigger, DNS updated.
</objective>

<execution_context>
@/Users/dweinbeck/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dweinbeck/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="checkpoint:human-action" gate="blocking">
  <name>Task 1: Delete Tasks Cloud Run service and Cloud Build trigger from GCP</name>
  <action>
These are GCP console / CLI operations that require the user's authenticated `gcloud` session against the correct project. Claude cannot perform these because the GCP project credentials are not available in the dev environment.

The user needs to run the following commands (or perform equivalent actions in the GCP Console):

**Step 1: Identify the todoist Cloud Run service name and project**

The todoist app was deployed as a separate Cloud Run service. Identify it:
```bash
# Check dev project
gcloud config set project personal-brand-dev-487114
gcloud run services list --region=us-central1 | grep -i todoist
```

**Step 2: Delete the Tasks Cloud Run service (DC-01)**

```bash
gcloud run services delete todoist --region=us-central1 --project=personal-brand-dev-487114 --quiet
```

If the service name is different from "todoist", use the actual name from Step 1.

**Step 3: Delete the tasks-deploy-dev Cloud Build trigger (DC-02)**

```bash
# List triggers to find the exact name/ID
gcloud builds triggers list --project=personal-brand-dev-487114 --format="table(name,id)"

# Delete the trigger (use actual name from list)
gcloud builds triggers delete tasks-deploy-dev --project=personal-brand-dev-487114 --quiet
```

If the trigger name is different, use the actual name from the list.

**Step 4: Remove or redirect the tasks subdomain DNS record (DC-03)**

The tasks subdomain DNS (tasks.dan-weinbeck.com, tasks.dev.dan-weinbeck.com) needs to be removed or redirected. This is typically managed in the domain registrar or Cloud DNS:

Option A (Remove): Delete the DNS A/CNAME records for `tasks.dan-weinbeck.com` and `tasks.dev.dan-weinbeck.com`.

Option B (Redirect): If the DNS provider supports URL redirects, set up a 301 redirect from `tasks.dan-weinbeck.com` to `https://dan-weinbeck.com/apps/tasks` and from `tasks.dev.dan-weinbeck.com` to `https://dev.dan-weinbeck.com/apps/tasks`.

If using Cloud DNS:
```bash
# List existing records
gcloud dns record-sets list --zone=YOUR_ZONE_NAME --project=personal-brand-dev-487114 | grep tasks
```

The redirect approach is preferred so that any existing bookmarks or links continue to work.
  </action>
  <verify>
After completing the steps:
1. `gcloud run services list --region=us-central1 --project=personal-brand-dev-487114` should NOT show a todoist/tasks service
2. `gcloud builds triggers list --project=personal-brand-dev-487114` should NOT show tasks-deploy-dev
3. Visiting tasks.dan-weinbeck.com should either show a DNS error (if removed) or redirect to dan-weinbeck.com/apps/tasks (if redirected)
  </verify>
  <done>
The standalone Tasks Cloud Run service is deleted, the tasks-deploy-dev Cloud Build trigger is deleted, and the tasks subdomain DNS is removed or redirected.
  </done>
</task>

</tasks>

<verification>
- `gcloud run services list` in the dev project shows no todoist/tasks service
- `gcloud builds triggers list` in the dev project shows no tasks-deploy-dev trigger
- DNS lookup for tasks.dan-weinbeck.com returns no result or redirects
</verification>

<success_criteria>
- DC-01: Standalone Tasks Cloud Run service is deleted
- DC-02: tasks-deploy-dev Cloud Build trigger is deleted
- DC-03: Tasks subdomain DNS record is removed or redirects to /apps/tasks
</success_criteria>

<output>
After completion, create `.planning/phases/48-decommission/48-01-SUMMARY.md`
</output>
